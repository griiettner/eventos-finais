---
id: "6c570618-88b2-4cc6-a625-b90bfb39ef99"
title: "Eventos Finais - Architecture & Tech Stack"
type: "entity"
tags: ["eventos-finais","firebase","kinde","docker","react","architecture"]
created: "2026-01-06T03:22:18.565Z"
updated: "2026-01-06T03:22:18.565Z"
related: []
importance: 1
---

# Eventos Finais - Architecture & Tech Stack

# Eventos Finais Project

## Overview
Portuguese-language Bible study PWA focused on end-times prophecy.

## Current Architecture (Jan 2026)

### Authentication
- **Provider**: Kinde (kinde.com)
- **Admin Role**: Managed via Kinde roles (check token claims for 'admin' role)
- **JWT Validation**: Backend validates Kinde JWT tokens

### Database
- **Primary DB**: Firebase/Firestore (migrated from SQLite WASM)
- **Collections**: chapters, chapterPages, questions, userProgress, user_answers
- **Access**: All writes go through backend API (Admin SDK bypasses security rules)
- **Firestore Rules**: Read-only for all users, writes only via backend API

### Backend API
- **Framework**: Express.js (server-firestore.cjs)
- **Port**: 3001
- **Authentication**: Kinde JWT validation via jwks-rsa
- **Firebase Admin**: Uses environment variables for credentials (not JSON file)
- **Endpoints**: /api/chapters, /api/chapters/:id/pages, /api/questions, /api/progress

### Frontend
- **Framework**: React 19 + TypeScript
- **Build Tool**: Vite/Rolldown
- **Auth**: @kinde-oss/kinde-auth-react
- **Routing**: react-router-dom
- **Animation**: Framer Motion
- **Port**: 5173 (dev)

### Docker Setup
- **Dev**: docker-compose.dev.yml (frontend + api services)
- **Prod**: docker-compose.yml (frontend + api services)
- **Firebase Credentials**: Via .env file (FIREBASE_PROJECT_ID, FIREBASE_CLIENT_EMAIL, FIREBASE_PRIVATE_KEY)
- **No JSON file mount**: Removed firebase-service-account.json from volumes

### Admin Features
- **Admin Dashboard**: /admin route (role-based access)
- **Chapter Editor**: /admin/chapter/new, /admin/chapter/:id
- **Multi-page chapters**: Supports subtitle, page_number, content, order_index
- **Rich text**: Markdown formatting support

### Important Notes
- **Field Naming**: Backend uses camelCase (pageNumber), frontend uses snake_case (page_number) - mapped in AdminService
- **Firestore Index**: Required composite index on chapterPages (chapterId + pageNumber)
- **User-facing pages**: Dashboard and ChapterDetail still need refactoring from SQLite to FirebaseService
- **SQLite removed**: All db/ folder and DBService references deleted

## Key Files
- server-firestore.cjs - Backend API
- src/services/admin-service.ts - Admin operations (uses API)
- src/services/firebase-service.ts - Firebase client SDK
- src/contexts/AuthContext.tsx - Kinde auth integration
- src/pages/AdminDashboard.tsx - Admin interface
- src/pages/AddEditChapter.tsx - Chapter editor