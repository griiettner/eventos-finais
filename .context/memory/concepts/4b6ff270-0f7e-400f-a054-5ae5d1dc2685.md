---
id: "4b6ff270-0f7e-400f-a054-5ae5d1dc2685"
title: "Docker Development & Production Setup"
type: "concept"
tags: ["docker","development","production","environment","volumes"]
created: "2026-01-06T03:33:02.986Z"
updated: "2026-01-06T03:33:02.986Z"
related: ["docker-setup","development-environment","production-deployment"]
importance: 0.8
---

# Docker Development & Production Setup

# Eventos Finais - Docker Development Setup

## Docker Compose Configuration

### Development Environment (docker-compose.dev.yml)
```yaml
services:
  frontend:
    build:
      context: .
      target: development
    ports:
      - "5173:5173"
    volumes:
      - .:/app
      - /app/node_modules
    env_file:
      - .env
    command: npm run dev
    
  api:
    build:
      context: .
      target: development
    ports:
      - "3001:3001"
    env_file:
      - .env
    environment:
      - PORT=3001
    command: node server-firestore.cjs
```

### Production Environment (docker-compose.yml)
```yaml
services:
  frontend:
    build:
      context: .
      target: production
    ports:
      - "80:80"
    environment:
      - NODE_ENV=production
      - VITE_API_URL=http://api:3001
    depends_on:
      - api
      
  api:
    build:
      context: .
      target: production
    ports:
      - "3001:3001"
    env_file:
      - .env
    environment:
      - NODE_ENV=production
      - PORT=3001
    command: node server-firestore.cjs
```

## Dockerfile Multi-stage Build

### Development Stage
```dockerfile
FROM node:18-alpine AS development
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
```

### Production Stage  
```dockerfile
FROM node:18-alpine AS build
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
```

## Volume Mounts & Environment

### Development Features
- **Hot Reload**: Entire project mounted as volume
- **Node Modules**: Separate volume to prevent conflicts
- **Environment**: .env file mounted
- **Port Mapping**: Frontend :5173, API :3001

### Production Features
- **Optimized**: Only production dependencies
- **Static Serving**: Nginx serves built frontend
- **Internal Communication**: API accessible via service name
- **No Volumes**: Immutable containers

## Environment Variables

### Required Variables (.env)
```bash
# Kinde Authentication
VITE_KINDE_DOMAIN=your-domain.kinde.com
VITE_KINDE_CLIENT_ID=your-client-id
VITE_KINDE_REDIRECT_URI=http://localhost:5173

# Firebase Configuration
VITE_FIREBASE_API_KEY=your-api-key
VITE_FIREBASE_PROJECT_ID=eventosfinais
VITE_FIREBASE_AUTH_DOMAIN=eventosfinais.firebaseapp.com

# API Configuration
VITE_API_URL=http://localhost:3001
```

## Development Commands

### Package.json Scripts
```json
{
  "docker:dev": "docker compose -f docker-compose.dev.yml up",
  "docker:dev:build": "docker compose -f docker-compose.dev.yml up --build -d",
  "docker:dev:down": "docker compose -f docker-compose.dev.yml down",
  "docker:dev:logs": "docker compose -f docker-compose.dev.yml logs -f",
  "docker:dev:restart": "docker compose -f docker-compose.dev.yml restart",
  "docker:clean": "docker compose -f docker-compose.dev.yml down -v && docker system prune -f"
}
```

## Network Configuration

### Service Communication
- **Frontend → API**: http://localhost:3001 (dev) or http://api:3001 (prod)
- **API → Firestore**: Direct via Firebase Admin SDK
- **API → Kinde**: JWKS endpoint for JWT validation

### Port Mappings
- **Frontend**: 5173 (dev), 80 (prod)
- **API**: 3001 (both)
- **Health Check**: /api/health

## Troubleshooting

### Common Issues
1. **Port Conflicts**: Ensure 5173 and 3001 are available
2. **Volume Mounts**: Check file permissions in host directory
3. **Environment Variables**: Verify .env file exists and is correct
4. **Build Failures**: Clear Docker cache with `docker system prune`

### Debug Commands
```bash
# View container logs
docker compose -f docker-compose.dev.yml logs api
docker compose -f docker-compose.dev.yml logs frontend

# Access container shell
docker compose -f docker-compose.dev.yml exec api sh
docker compose -f docker-compose.dev.yml exec frontend sh

# Rebuild specific service
docker compose -f docker-compose.dev.yml up --build api
```

## Performance Considerations

### Development
- Hot reload enabled for rapid development
- Source maps included for debugging
- Development dependencies installed

### Production
- Optimized builds only
- Minimal image sizes
- No development overhead
- Static asset serving via Nginx